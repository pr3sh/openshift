## **`Abstract:`**

The objective of this guide is to understand the basics of troubleshooting containerized applications.
-  **Table of contents**:
  - [Introduction](#introduction)
  - [Common Issues](common-issues)
  - [Troubleshooting Volume Mounts](troubleshooting-volume-mounts)
  - [Transferring Files To and Out of Containers](transferring-files-to-and-out-of-containers)
#### **`Introduction:`**
Before diving into any source code it is quintenssential to understand the basic workflows of the application creation process. The **`S2I`** image creation process is composed of two main steps:

1. **Build:** In this step, source code is compiled and the application is packaged as a container image. The build step also pushes the image to the OpenShift registry for the deployment step. The **`BuildConfig`** OpenShift resources is the driver of this step. 

2. **`Deployment:`** This step executes after the build step only if the build step succeeded. The **`DeploymentConfig`** OpenShift resources are the driver of the deployment step.

3. The build process creates a pod named **`<application-name>-build-<number>-<string>`**. The application starts on a separate pod named as **`<application-name>-<string>`**.

> To retrieve the logs from a build configuration.
```zsh
$ oc logs bc/<application-name>
```
> To restart the build. 
```zsh
$ oc start-build <application-name>
```
> To retrieve the logs from a deployment configuration.
```zsh
$ $ oc logs dc/<application-name>
```
#### **`Common Issues:`** 
Some containers may require a specific user ID, whereas S2I is designed to run containers using a random user as per the default OpenShift security policy.
> The **`Dockerfile`** below creates a Nexus container where the **`USER`** instruction indicating the nexus user should be used.
```Dockerfile
FROM ubi7/ubi:7.7

RUN chown -R nexus:nexus ${NEXUS_HOME}

USER nexus
WORKDIR ${NEXUS_HOME}

VOLUME ["/opt/nexus/sonatype-work"]
```
> Trying to use the image generated by this Dockerfile without adequate volume permissions will result in the errors below.
```zsh
$ oc logs nexus-1-wzjrn
...output omitted...
... org.sonatype.nexus.util.LockFile - Failed to write lock file
...FileNotFoundException: /opt/nexus/sonatype-work/nexus.lock (Permission denied)
...output omitted...
... org.sonatype.nexus.webapp.WebappBootstrap - Failed to initialize
...lStateException: Nexus work directory already in use: /opt/nexus/sonatype-work
...output omitted...
```
> To fix this issue, you must run the below command to enable OpenShift executing container processes with non-root users. 
```zsh
$ oc adm policy add-scc-to-user anyuid -z default
```

#### **`Troubleshooting Volume Mounts:`**
When redeploying an application that uses a persistent volume on a local file system, a pod might not be able to allocate a persistent volume claim even though the persistent volume indicates that the claim is released. To resolve the issue, delete the persistent volume claim and then the persistent volume. Then recreate the persistent volume as shown below.
```zsh
$ oc delete pv <pv_name>
$ oc create -f <pv_resource_file>
```
> If you push a new image to the registry with the same name and tag, you must remove the image from each node the pod is scheduled by executing the **`podman rmi`** command.
> An automated way to remove obsolete images and other resources, execute the **`oc adm prune`** command.

#### **`Transferring Files To and Out of Containers:`**

During your troubleshooting steps, you may need to retrieve or even transfer file to and from a container that's running. An example of this could be log files, or even configuration files. There are several methods for acheiveing this goal such as:
	- **Volume Mounts:** Mouting a local directory to that of a container to copy contents into container.
	- **`podman cp`** command to copy files both in and out of running containers.
	- **`podman exec`** command to pipe files in and out of a container, while executing a command within the container. using the same methodology, we an also retrieve data from a running container and place it in the host machine as well.
> *Below are demonstrations of the described concepts above.*

- Mount local directory to container.
```zsh
$ sudo podman run -v /conf:/etc/httpd/conf -d do180/apache
```
- Copy 






